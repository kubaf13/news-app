{"ast":null,"code":"var _jsxFileName = \"/Users/kubaf/Desktop/react-news-app-master-2/src/components/Main/HomePage/HomePage.jsx\";\nimport React, { Component } from \"react\";\nimport \"./HomePage.css\";\nimport NewsFiltersBar from \"./NewsFiltersBar/NewsFiltersBar\";\nimport NewsList from \"./NewsList/NewsList\";\nimport LanguageContext from \"../../../LanguageContext\";\n\nclass HomePage extends Component {\n  constructor(props) {\n    super(props);\n\n    this.setCategory = category => this.setState({\n      category,\n      page: 1\n    });\n\n    this.setSearchQuery = searchQuery => {\n      this.setState({\n        searchQuery\n      });\n      if (searchQuery) this.setState({\n        page: 1\n      });\n    };\n\n    this.setPage = page => this.setState({\n      page\n    });\n\n    this.state = {\n      results: null,\n      category: \"general\",\n      searchQuery: null,\n      lang: \"\",\n      pagesNumber: 1,\n      page: 1\n    };\n  }\n\n  componentDidMount() {\n    this.setState({\n      lang: this.context\n    });\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevState.category !== this.state.category || prevState.searchQuery !== this.state.searchQuery || prevState.lang !== this.state.lang || prevState.page !== this.state.page) {\n      this.getArticles();\n    }\n\n    if (this.context !== this.state.lang) this.setState({\n      lang: this.context,\n      page: 1\n    });\n  }\n\n  getQuery() {\n    const {\n      category,\n      searchQuery\n    } = this.state;\n    let query;\n\n    if (category) {\n      query = searchQuery ? `&category=${category}&q=${searchQuery}` : `&category=${category}`;\n    } else {\n      query = searchQuery ? `&q=${searchQuery}` : \"\";\n    }\n\n    return query;\n  }\n\n  getArticles() {\n    const {\n      lang,\n      page\n    } = this.state;\n    fetch(`http://localhost:3000/articles?country=${lang}${this.getQuery()}&page=${page}`).then(response => response.json()).then(results => {\n      this.setState({\n        results\n      });\n      this.setState({\n        pagesNumber: Math.ceil(results.totalResults / 15)\n      });\n    });\n  }\n\n  render() {\n    const {\n      results,\n      pagesNumber,\n      page\n    } = this.state;\n    if (!results) return null;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      id: \"HomePage\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(NewsFiltersBar, {\n      onCategoryChange: this.setCategory,\n      onSearchQueryChange: this.setSearchQuery,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }\n    }), results.totalResults !== 0 ? /*#__PURE__*/React.createElement(NewsList, {\n      articles: results.articles.filter((item, index, self) => {\n        return index === self.findIndex(t => t.title === item.title);\n      }),\n      onPageChange: this.setPage,\n      pagesNumber: pagesNumber,\n      currentPage: page,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 11\n      }\n    }) : /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 11\n      }\n    }, \"No results\"));\n  }\n\n}\n\nHomePage.contextType = LanguageContext;\nexport default HomePage;","map":{"version":3,"sources":["/Users/kubaf/Desktop/react-news-app-master-2/src/components/Main/HomePage/HomePage.jsx"],"names":["React","Component","NewsFiltersBar","NewsList","LanguageContext","HomePage","constructor","props","setCategory","category","setState","page","setSearchQuery","searchQuery","setPage","state","results","lang","pagesNumber","componentDidMount","context","componentDidUpdate","prevProps","prevState","getArticles","getQuery","query","fetch","then","response","json","Math","ceil","totalResults","render","articles","filter","item","index","self","findIndex","t","title","contextType"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport \"./HomePage.css\";\nimport NewsFiltersBar from \"./NewsFiltersBar/NewsFiltersBar\";\nimport NewsList from \"./NewsList/NewsList\";\nimport LanguageContext from \"../../../LanguageContext\";\n\nclass HomePage extends Component {\n  static contextType = LanguageContext;\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      results: null,\n      category: \"general\",\n      searchQuery: null,\n      lang: \"\",\n      pagesNumber: 1,\n      page: 1,\n    };\n  }\n\n  componentDidMount() {\n    this.setState({ lang: this.context });\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (\n      prevState.category !== this.state.category ||\n      prevState.searchQuery !== this.state.searchQuery ||\n      prevState.lang !== this.state.lang ||\n      prevState.page !== this.state.page\n    ) {\n      this.getArticles();\n    }\n    if (this.context !== this.state.lang)\n      this.setState({ lang: this.context, page: 1 });\n  }\n\n  getQuery() {\n    const { category, searchQuery } = this.state;\n\n    let query;\n    if (category) {\n      query = searchQuery\n        ? `&category=${category}&q=${searchQuery}`\n        : `&category=${category}`;\n    } else {\n      query = searchQuery ? `&q=${searchQuery}` : \"\";\n    }\n    return query;\n  }\n\n  getArticles() {\n    const { lang, page } = this.state;\n\n    fetch(\n      `http://localhost:3000/articles?country=${lang}${this.getQuery()}&page=${page}`\n    )\n      .then((response) => response.json())\n      .then((results) => {\n        this.setState({ results });\n        this.setState({\n          pagesNumber: Math.ceil(results.totalResults / 15),\n        });\n      });\n  }\n\n  setCategory = (category) => this.setState({ category, page: 1 });\n  setSearchQuery = (searchQuery) => {\n    this.setState({ searchQuery });\n    if (searchQuery) this.setState({ page: 1 });\n  };\n\n  setPage = (page) => this.setState({ page });\n\n  render() {\n    const { results, pagesNumber, page } = this.state;\n\n    if (!results) return null;\n\n    return (\n      <div id=\"HomePage\">\n        <NewsFiltersBar\n          onCategoryChange={this.setCategory}\n          onSearchQueryChange={this.setSearchQuery}\n        />\n        {results.totalResults !== 0 ? (\n          <NewsList\n            articles={results.articles.filter((item, index, self) => {\n              return index === self.findIndex((t) => t.title === item.title);\n            })}\n            onPageChange={this.setPage}\n            pagesNumber={pagesNumber}\n            currentPage={page}\n          />\n        ) : (\n          <h1>No results</h1>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default HomePage;\n"]},"metadata":{},"sourceType":"module"}